---
import { getPageCanonicalUrl } from '../utils/canonical.ts';
import WebVitalsOptimizer from '../components/WebVitalsOptimizer.astro';
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		
		<!-- Core Web Vitals Optimizations -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link rel="dns-prefetch" href="//unpkg.com" />
		<link rel="preload" href="/favicon.svg" as="image" type="image/svg+xml" />
		<meta name="generator" content={Astro.generator} />
		<title>{Astro.props.title || "Nail 90 Spa — Green, Ohio"}</title>
		
		<!-- Critical CSS for above-the-fold content -->
		<style>
			/* Critical CSS for above-the-fold content - Nail 90 Spa */
			
			/* Reset and base styles */
			* { box-sizing: border-box; }
			html { font-family: system-ui, -apple-system, sans-serif; line-height: 1.6; }
			body { margin: 0; color: #1f2937; background: #fff; }
			
			/* Layout */
			.container { max-width: 1200px; margin: 0 auto; padding: 0 1rem; }
			
			/* Header - Critical for LCP */
			.site-header {
				background: #fff;
				border-bottom: 1px solid #e5e7eb;
				position: sticky;
				top: 0;
				z-index: 100;
				padding: 1rem 0;
			}
			
			.nav {
				display: flex;
				align-items: center;
				gap: 1.5rem;
				flex-wrap: wrap;
			}
			
			.brand {
				font-size: 1.5rem;
				font-weight: 700;
				color: #1f2937;
				text-decoration: none;
			}
			
			.spacer { flex: 1; }
			
			.nav a {
				color: #6b7280;
				text-decoration: none;
				font-weight: 500;
				transition: color 0.2s;
			}
			
			.nav a:hover { color: #1f2937; }
			
			.btn {
				background: #dc2626;
				color: white;
				padding: 0.5rem 1rem;
				border-radius: 0.375rem;
				text-decoration: none;
				font-weight: 500;
				transition: background 0.2s;
			}
			
			.btn:hover { background: #b91c1c; }
			
			/* Hero section - Critical for LCP */
			.hero {
				padding: 3rem 0 2rem;
				text-align: center;
				background: linear-gradient(135deg, #fef7f7 0%, #f9fafb 100%);
			}
			
			.hero h1 {
				font-size: 3rem;
				font-weight: 800;
				color: #1f2937;
				margin: 0 0 1rem 0;
				line-height: 1.1;
			}
			
			.hero p {
				font-size: 1.25rem;
				color: #6b7280;
				margin: 0 0 2rem 0;
				max-width: 600px;
				margin-left: auto;
				margin-right: auto;
			}
			
			.cta {
				display: flex;
				gap: 1rem;
				justify-content: center;
				flex-wrap: wrap;
				margin-bottom: 2rem;
			}
			
			.link {
				color: #dc2626;
				text-decoration: none;
				font-weight: 500;
			}
			
			.link:hover { text-decoration: underline; }
			
			/* Services grid - Critical for above-fold */
			.services {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
				gap: 1.5rem;
				margin: 2rem 0;
			}
			
			.card {
				background: #fff;
				border: 1px solid #e5e7eb;
				border-radius: 0.5rem;
				padding: 1.5rem;
				box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
				transition: transform 0.2s, box-shadow 0.2s;
			}
			
			.card:hover {
				transform: translateY(-2px);
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			}
			
			.card h3 {
				margin: 0 0 0.5rem 0;
				color: #1f2937;
				font-size: 1.25rem;
				font-weight: 600;
			}
			
			.card p {
				margin: 0 0 1rem 0;
				color: #6b7280;
				line-height: 1.5;
			}
			
			.price {
				font-size: 1.5rem;
				font-weight: 700;
				color: #dc2626;
				margin: 0;
			}
			
			/* Responsive design - Critical for mobile */
			@media (max-width: 768px) {
				.hero h1 { font-size: 2.25rem; }
				.hero p { font-size: 1.125rem; }
				.nav { flex-direction: column; gap: 1rem; }
				.spacer { display: none; }
				.services { grid-template-columns: 1fr; }
				.cta { flex-direction: column; align-items: center; }
			}
			
			@media (max-width: 480px) {
				.hero { padding: 2rem 0 1rem; }
				.hero h1 { font-size: 1.875rem; }
				.container { padding: 0 0.75rem; }
			}
			
			/* Performance optimizations */
			img { max-width: 100%; height: auto; }
			.lazy-image { opacity: 0; transition: opacity 0.3s ease; }
			.lazy-image.loaded { opacity: 1; }
			
			/* Prevent layout shift */
			.hero, .services, .card { contain: layout; }
		</style>
		<meta name="description" content={Astro.props.description || "Nail 90 Spa in Green, Ohio — manicures, pedicures, gel, acrylic, and nail art."} />
		<meta name="keywords" content="nail salon Green Ohio, manicure Green OH, pedicure near me, gel manicure Green, acrylic nails Green, nail art Green Ohio, dip powder, spa pedicure" />
		<meta property="og:title" content={Astro.props.title || "Nail 90 Spa — Green, Ohio"} />
		<meta property="og:description" content={Astro.props.description || "Modern nail services in Green, Ohio: manicures, pedicures, gel, acrylic, nail art."} />
		<meta property="og:type" content="website" />
		<meta property="og:url" content="https://nai-salon.vercel.app/" />
		<meta property="og:image" content="/favicon.svg" />
		<meta name="twitter:card" content="summary" />
		<link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml" />
		<link rel="canonical" href={getPageCanonicalUrl(Astro.url.pathname)} />
		<script type="application/ld+json">{JSON.stringify({
			"@context": "https://schema.org",
			"@type": "NailSalon",
			"name": "Nail 90 Spa",
			"description": "Professional nail salon in Green, Ohio offering acrylic nails, gel manicures, pedicures, nail art, and emergency nail repair services.",
			"address": {
				"@type": "PostalAddress",
				"streetAddress": "1234 Massillon Rd",
				"addressLocality": "Green",
				"addressRegion": "OH",
				"postalCode": "44685",
				"addressCountry": "US"
			},
			"telephone": "+1-330-555-0199",
			"email": "info@nail90spa.com",
			"url": "https://nai-salon.vercel.app/",
			"areaServed": [
				{"@type": "City", "name": "Green", "containedInPlace": {"@type": "State", "name": "Ohio"}},
				{"@type": "City", "name": "Canton", "containedInPlace": {"@type": "State", "name": "Ohio"}},
				{"@type": "City", "name": "North Canton", "containedInPlace": {"@type": "State", "name": "Ohio"}}
			],
			"image": "https://nai-salon.vercel.app/favicon.svg",
			"priceRange": "$15-$75",
			"openingHours": "Tu-Sa 09:00-18:00",
			"serviceArea": {
				"@type": "GeoCircle",
				"geoMidpoint": {
					"@type": "GeoCoordinates",
					"latitude": 40.9459,
					"longitude": -81.4834
				},
				"geoRadius": "15000"
			},
			"hasOfferCatalog": {
				"@type": "OfferCatalog",
				"name": "Nail Services Catalog",
				"itemListElement": [
					{
						"@type": "Offer",
						"name": "Acrylic Nails",
						"description": "Professional acrylic nail services including full sets, fills, and repairs",
						"itemOffered": {
							"@type": "Service",
							"name": "Acrylic Nails",
							"description": "Strong, durable acrylic nail extensions and repairs",
							"provider": {"@type": "NailSalon", "name": "Nail 90 Spa"},
							"areaServed": ["Green, Ohio", "Canton, Ohio", "North Canton, Ohio"],
							"offers": [
								{"@type": "Offer", "name": "Acrylic Full Set", "price": "65", "priceCurrency": "USD"},
								{"@type": "Offer", "name": "Acrylic Fill", "price": "40", "priceCurrency": "USD"},
								{"@type": "Offer", "name": "Acrylic Repair", "price": "15", "priceCurrency": "USD"}
							]
						}
					},
					{
						"@type": "Offer",
						"name": "Gel Manicures",
						"description": "Long-lasting gel manicures and shellac nail services",
						"itemOffered": {
							"@type": "Service",
							"name": "Gel Manicures",
							"description": "Chip-free gel manicures lasting 2-3 weeks",
							"provider": {"@type": "NailSalon", "name": "Nail 90 Spa"},
							"areaServed": ["Green, Ohio", "Canton, Ohio", "North Canton, Ohio"],
							"offers": [
								{"@type": "Offer", "name": "Gel Manicure", "price": "45", "priceCurrency": "USD"},
								{"@type": "Offer", "name": "Shellac Manicure", "price": "50", "priceCurrency": "USD"},
								{"@type": "Offer", "name": "Gel Removal", "price": "20", "priceCurrency": "USD"}
							]
						}
					},
					{
						"@type": "Offer",
						"name": "Manicures",
						"description": "Classic and luxury manicure services",
						"itemOffered": {
							"@type": "Service",
							"name": "Manicures",
							"description": "Professional manicure services for healthy, beautiful nails",
							"provider": {"@type": "NailSalon", "name": "Nail 90 Spa"},
							"areaServed": ["Green, Ohio", "Canton, Ohio", "North Canton, Ohio"],
							"offers": [
								{"@type": "Offer", "name": "Classic Manicure", "price": "30", "priceCurrency": "USD"},
								{"@type": "Offer", "name": "French Manicure", "price": "40", "priceCurrency": "USD"},
								{"@type": "Offer", "name": "Luxury Manicure", "price": "55", "priceCurrency": "USD"}
							]
						}
					},
					{
						"@type": "Offer",
						"name": "Pedicures",
						"description": "Relaxing pedicure services from express to deluxe",
						"itemOffered": {
							"@type": "Service",
							"name": "Pedicures",
							"description": "Professional pedicure services for healthy, beautiful feet",
							"provider": {"@type": "NailSalon", "name": "Nail 90 Spa"},
							"areaServed": ["Green, Ohio", "Canton, Ohio", "North Canton, Ohio"],
							"offers": [
								{"@type": "Offer", "name": "Express Pedicure", "price": "35", "priceCurrency": "USD"},
								{"@type": "Offer", "name": "Spa Pedicure", "price": "55", "priceCurrency": "USD"},
								{"@type": "Offer", "name": "Deluxe Pedicure", "price": "75", "priceCurrency": "USD"}
							]
						}
					},
					{
						"@type": "Offer",
						"name": "Nail Art",
						"description": "Creative nail art designs and specialty techniques",
						"itemOffered": {
							"@type": "Service",
							"name": "Nail Art",
							"description": "Creative nail art designs from simple to complex",
							"provider": {"@type": "NailSalon", "name": "Nail 90 Spa"},
							"areaServed": ["Green, Ohio", "Canton, Ohio", "North Canton, Ohio"],
							"offers": [
								{"@type": "Offer", "name": "Simple Nail Art", "price": "5", "priceCurrency": "USD", "priceSpecification": {"@type": "UnitPriceSpecification", "price": "5", "priceCurrency": "USD", "unitText": "per nail"}},
								{"@type": "Offer", "name": "Complex Nail Art", "price": "10", "priceCurrency": "USD", "priceSpecification": {"@type": "UnitPriceSpecification", "price": "10", "priceCurrency": "USD", "unitText": "per nail"}},
								{"@type": "Offer", "name": "Specialty Techniques", "price": "15", "priceCurrency": "USD", "priceSpecification": {"@type": "UnitPriceSpecification", "price": "15", "priceCurrency": "USD", "unitText": "per nail"}}
							]
						}
					},
					{
						"@type": "Offer",
						"name": "Nail Extensions",
						"description": "Professional nail extensions in acrylic, gel, and polygel",
						"itemOffered": {
							"@type": "Service",
							"name": "Nail Extensions",
							"description": "Professional nail extensions for length and strength",
							"provider": {"@type": "NailSalon", "name": "Nail 90 Spa"},
							"areaServed": ["Green, Ohio", "Canton, Ohio", "North Canton, Ohio"],
							"offers": [
								{"@type": "Offer", "name": "Acrylic Extensions", "price": "65", "priceCurrency": "USD"},
								{"@type": "Offer", "name": "Gel Extensions", "price": "70", "priceCurrency": "USD"},
								{"@type": "Offer", "name": "Polygel Extensions", "price": "75", "priceCurrency": "USD"}
							]
						}
					},
					{
						"@type": "Offer",
						"name": "Emergency Nail Repair",
						"description": "Same-day nail repair services for broken or damaged nails",
						"itemOffered": {
							"@type": "Service",
							"name": "Emergency Nail Repair",
							"description": "Urgent nail repair services for broken, chipped, or damaged nails",
							"provider": {"@type": "NailSalon", "name": "Nail 90 Spa"},
							"areaServed": ["Green, Ohio", "Canton, Ohio", "North Canton, Ohio"],
							"offers": [
								{"@type": "Offer", "name": "Broken Nail Repair", "price": "15", "priceCurrency": "USD"},
								{"@type": "Offer", "name": "Chipped Nail Fix", "price": "10", "priceCurrency": "USD"},
								{"@type": "Offer", "name": "Lifted Nail Repair", "price": "20", "priceCurrency": "USD"}
							]
						}
					}
				]
			},
			"paymentAccepted": ["Cash", "Credit Card", "Debit Card"],
			"currenciesAccepted": "USD",
			"amenityFeature": [
				{"@type": "LocationFeatureSpecification", "name": "Walk-in Appointments", "value": true},
				{"@type": "LocationFeatureSpecification", "name": "Emergency Services", "value": true},
				{"@type": "LocationFeatureSpecification", "name": "Parking Available", "value": true}
			],
			"sameAs": []
		})}</script>
		<!-- HTMX loaded asynchronously for better FID -->
		<script data-defer src="https://unpkg.com/htmx.org@1.9.12" integrity="sha384-9I8Pj8y0zG7mQp9nqg9lZC6mZ3wQkSg9l7q7uZ3gk2jz2v3k9P3l0rL7q2nX8Qv1" crossorigin="anonymous"></script>
		
		<!-- Non-critical CSS loading -->
		<link rel="preload" href="/styles/non-critical.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
		<noscript><link rel="stylesheet" href="/styles/non-critical.css"></noscript>
		
		<!-- Web Vitals optimization script -->
		<script src="/js/web-vitals.js" defer></script>
		
		<!-- Lazy Loading Styles -->
		<style>
			/* Global lazy loading styles */
			img[loading="lazy"] {
				opacity: 0;
				transition: opacity 0.3s ease;
			}
			
			img[loading="lazy"].loaded {
				opacity: 1;
			}
			
			/* Shimmer loading effect */
			.lazy-image-container::before {
				content: '';
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: linear-gradient(90deg, #f3f4f6 25%, #e5e7eb 50%, #f3f4f6 75%);
				background-size: 200% 100%;
				animation: shimmer 1.5s infinite;
				z-index: 1;
			}
			
			.lazy-image-container.loaded::before {
				display: none;
			}
			
			@keyframes shimmer {
				0% { background-position: -200% 0; }
				100% { background-position: 200% 0; }
			}
			
			/* Performance optimization */
			img {
				content-visibility: auto;
			}
		</style>
		
		<!-- Global Lazy Loading Enhancement -->
		<script>
			// Enhanced lazy loading for all images
			(function() {
				'use strict';
				
				// Check if Intersection Observer is supported
				if (!('IntersectionObserver' in window)) {
					// Fallback: load all images immediately
					document.querySelectorAll('img[loading="lazy"]').forEach(img => {
						img.loading = 'eager';
					});
					return;
				}
				
				// Create intersection observer for lazy loading
				const imageObserver = new IntersectionObserver((entries, observer) => {
					entries.forEach(entry => {
						if (entry.isIntersecting) {
							const img = entry.target;
							
							// Load the image
							if (img.dataset.src) {
								img.src = img.dataset.src;
								img.removeAttribute('data-src');
							}
							
							// Add loaded class for styling
							img.addEventListener('load', () => {
								img.classList.add('loaded');
							});
							
							// Stop observing this image
							observer.unobserve(img);
						}
					});
				}, {
					root: null,
					rootMargin: '50px 0px',
					threshold: 0.1
				});
				
				// Observe all lazy images
				function observeImages() {
					document.querySelectorAll('img[loading="lazy"]').forEach(img => {
						imageObserver.observe(img);
					});
				}
				
				// Initialize on DOM ready
				if (document.readyState === 'loading') {
					document.addEventListener('DOMContentLoaded', observeImages);
				} else {
					observeImages();
				}
				
				// Re-observe on page navigation (for SPA-like behavior)
				document.addEventListener('astro:page-load', observeImages);
			})();
		</script>
	</head>
	<body>
		<WebVitalsOptimizer />
		<header class="site-header">
			<nav class="nav" hx-boost="true">
				<a class="brand" href="/">Nail 90 Spa</a>
				<div class="spacer"></div>
				<a href="/services">Services</a>
				<a href="/locations">Locations</a>
				<a href="/about">About</a>
				<a href="/blog">Blog</a>
				<a href="/acrylic-nails">Acrylic</a>
				<a href="/gel-nails">Gel</a>
				<a href="/nail-art">Nail Art</a>
				<a class="btn" href="/book">Book</a>
				<a class="btn" href="/contact">Contact</a>
			</nav>
		</header>
		<main class="container">
		<slot />
		</main>
		<footer class="site-footer">
			<p>© {new Date().getFullYear()} Nai Salon — Green, Ohio</p>
		</footer>
	</body>
</html>

<style>
	html,
	body {
		margin: 0;
		width: 100%;
		height: 100%;
		font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
		color: #111827;
		background: #ffffff;
	}
	:root {
		--accent: #0ea5e9; /* sky-500 */
		--accent-600: #0284c7;
		--muted: #f3f4f6;
		--border: #e5e7eb;
	}
	.site-header {
		position: sticky;
		top: 0;
		z-index: 10;
		background: rgba(255,255,255,0.8);
		backdrop-filter: saturate(180%) blur(8px);
		border-bottom: 1px solid var(--border);
	}
	.nav {
		display: flex;
		align-items: center;
		gap: 1rem;
		max-width: 1000px;
		margin: 0 auto;
		padding: 0.75rem 1rem;
	}
	.nav a {
		text-decoration: none;
		color: #1f2937;
		font-weight: 500;
	}
	.nav a:hover { color: var(--accent); }
	.brand { font-weight: 700; }
	.spacer { flex: 1; }
	.btn {
		padding: 0.4rem 0.8rem;
		border-radius: 0.375rem;
		background: var(--accent);
		color: white !important;
	}
	.btn:hover { background: var(--accent-600); }
	.container {
		max-width: 1000px;
		margin: 0 auto;
		padding: 2rem 1rem 4rem;
	}
	.site-footer {
		border-top: 1px solid var(--border);
		background: var(--muted);
		padding: 1rem;
		text-align: center;
		color: #4b5563;
	}
</style>
